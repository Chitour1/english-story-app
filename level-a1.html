<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>قصتي اللغوية — المستوى A1</title>

  <!-- Tailwind + الخطوط -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Inter:wght@400;700&display=swap" rel="stylesheet"/>

  <!-- CSS الموحّد -->
  <link rel="stylesheet" href="./assets/css/styles.css"/>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen pb-24" style="font-family:'Cairo',sans-serif">

  <div class="container mx-auto max-w-4xl p-4 md:p-8">
    <!-- رأس الصفحة -->
    <header class="mb-4 flex items-center justify-between gap-4">
      <a data-nav="levels.html" class="text-sky-700 hover:underline flex items-center gap-1 cursor-pointer">
        ← المستويات
      </a>
      <div class="text-center flex-1">
        <h1 class="text-2xl md:text-3xl font-bold text-sky-600">المستوى A1</h1>
        <p class="text-slate-600 mt-1">قصص وتمارين مع مراجعة ذكية وصوتيات</p>
      </div>
      <a data-nav="key.html" class="text-sky-700 hover:underline cursor-pointer">مفتاح Gemini</a>
    </header>

    <!-- إحصاءات أعلى الصفحة (يحدّثها main-a1.js) -->
    <section class="mb-6 p-4 bg-white rounded-lg shadow-md flex flex-wrap justify-around text-center">
      <div><p class="text-slate-500">إجمالي كلمات A1</p><p id="total-words" class="text-2xl font-bold text-sky-600 font-english">0</p></div>
      <div><p class="text-slate-500">تعلمتها</p><p id="learned-words" class="text-2xl font-bold text-green-600 font-english">0</p></div>
      <div><p class="text-slate-500">المتبقية</p><p id="remaining-words" class="text-2xl font-bold text-amber-600 font-english">0</p></div>
    </section>

    <!-- تبويبات -->
    <nav class="mb-4 flex justify-center border-b flex-wrap">
      <button id="nav-home" class="px-4 py-3 text-lg font-bold border-b-4 border-sky-600 text-sky-600">الرئيسية</button>
      <button id="nav-history" class="px-4 py-3 text-lg font-bold border-b-4 border-transparent text-slate-500 hover:text-sky-600">سجل الدروس</button>
      <button id="nav-in-progress" class="px-4 py-3 text-lg font-bold border-b-4 border-transparent text-slate-500 hover:text-sky-600">كلمات قيد التعلم</button>
      <button id="nav-basket" class="px-4 py-3 text-lg font-bold border-b-4 border-transparent text-slate-500 hover:text-sky-600">سلة المراجعة</button>
    </nav>

    <!-- الشاشات -->
    <!-- الرئيسية -->
    <section id="home-screen" class="text-center p-6 bg-white rounded-lg shadow-md">
      <h2 class="text-2xl font-bold mb-3">هل أنت مستعد لدرس جديد؟</h2>
      <p class="text-slate-600 mb-6">حدد عدد كلمات القصة وأضف تعليمات خاصة إن رغبت.</p>

      <div class="max-w-md mx-auto space-y-4 mb-6 text-right">
        <div>
          <label for="word-count-home" class="block text-sm font-medium text-slate-700">إجمالي كلمات القصة (تقريبياً 50–500)</label>
          <input type="number" id="word-count-home" value="100" min="50" max="500" class="mt-1 block w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-sky-500 focus:border-sky-500"/>
        </div>
        <div>
          <label for="custom-prompt-home" class="block text-sm font-medium text-slate-700">تعليمات للقصة (اختياري)</label>
          <textarea id="custom-prompt-home" rows="2" class="mt-1 block w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-sky-500 focus:border-sky-500" placeholder="مثال: قصة عن حيوانات في حديقة، للأطفال…"></textarea>
        </div>
      </div>

      <button id="new-lesson-btn" class="bg-green-600 text-white px-8 py-3 rounded-lg text-lg font-bold hover:bg-green-700 transition">
        أنشئ قصة جديدة
      </button>
      <button id="reset-progress-btn" class="mt-4 bg-red-500 text-white px-4 py-2 rounded-md text-sm hover:bg-red-600 transition">
        إعادة تعيين التقدم
      </button>
    </section>

    <!-- سجل الدروس -->
    <section id="history-screen" class="hidden p-6 bg-white rounded-lg shadow-md">
      <h2 class="text-2xl font-bold mb-4 text-center">الدروس السابقة</h2>
      <div id="history-list" class="space-y-2"></div>
    </section>

    <!-- كلمات قيد التعلّم -->
    <section id="in-progress-screen" class="hidden p-6 bg-white rounded-lg shadow-md">
      <!-- يُملؤه main-a1.js -->
    </section>

    <!-- سلة المراجعة -->
    <section id="basket-screen" class="hidden p-6 bg-white rounded-lg shadow-md">
      <!-- يُملؤه main-a1.js -->
    </section>

    <!-- شاشة تحميل بينية -->
    <section id="loading-screen" class="hidden text-center p-8 bg-white rounded-lg shadow-md">
      <div class="flex justify-center mb-4">
        <div class="w-12 h-12 rounded-full border-4 border-slate-200 border-t-sky-600 animate-spin"></div>
      </div>
      <p class="text-slate-600 text-lg">الذكاء الاصطناعي يكتب قصتك…</p>
    </section>

    <!-- شاشة الدرس (يتم الحقن بداخلها) -->
    <section id="lesson-screen" class="hidden space-y-6" data-lesson-ready="0">
      <!-- LESSONS.renderLesson سيبني المحتوى كاملًا هنا -->
    </section>
  </div>

  <!-- جذور الواجهات المشتركة (من ui.js) -->
  <div id="global-modal-root"></div>
  <div id="screen-loader" class="hidden fixed inset-0 z-50 bg-black/50 backdrop-blur-sm">
    <div class="absolute inset-0 flex items-center justify-center p-4">
      <div class="bg-white rounded-xl p-6 w-full max-w-xs text-center shadow-2xl">
        <div class="mx-auto mb-3 w-10 h-10 rounded-full border-4 border-slate-200 border-t-sky-600 animate-spin"></div>
        <div id="screen-loader-text" class="font-bold">جاري التحميل…</div>
      </div>
    </div>
  </div>

  <!-- شريط قانوني -->
  <footer id="legal-bar-root"></footer>

  <!-- ترتيب تحميل السكربتات مهم -->
  <script src="./assets/js/config.js"></script>
  <script src="./assets/js/ui.js"></script>
  <script src="./assets/js/state.js"></script>
  <script src="./assets/js/tts.js"></script>
  <script src="./assets/js/lessons.js"></script>
  <script src="./assets/js/auth.js"></script>
  <script src="./assets/js/common.js"></script>
  <script src="./assets/js/main-a1.js"></script>
</body>
</html>
